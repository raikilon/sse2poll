<main class="page">
  <section class="panel">
    <p class="eyebrow">SSE2Poll demo</p>
    <h1>Catalog lookup with polling</h1>

    <p class="lead">
      Select a product to automatically fetch and poll until ready.
    </p>

    <div class="controls">
      <label for="product">Product</label>

      <div class="input-row">
        <select
          id="product"
          name="product"
          [value]="productId() ?? ''"
          (change)="onProductSelect($event)"
        >
          <option value="">— Select a product —</option>

          @for (product of availableProducts; track product) {
            <option [value]="product">
              {{ product }}
            </option>
          }
        </select>
      </div>

      <p class="hint">
        Polling begins automatically for the selected product.
      </p>
    </div>

    @if (productResource.status() === 'loading') {
      <div class="status">
        Waiting for the backend to finish…
      </div>
    }

    @if (productResource.value(); as payload) {
      <article class="result-card">
        <header>
          <p class="eyebrow success">Result ready</p>
          <h2>{{ payload.name }}</h2>
        </header>

        <p class="muted">{{ payload.description }}</p>
        <p class="price">
          {{ payload.price | currency:'USD':'symbol' }}
        </p>

        <pre class="json">
<code>{{ payload | json }}</code>
        </pre>
      </article>
    }

    @if (productResource.error(); as err) {
      <p class="error">
        {{ formatError(err) }}
      </p>
    }
  </section>
</main>
